# ==============================================
# Policy File of /vendor/bin/hw/vendor.mediatek.hardware.mms@1.0-service Executable File

# ==============================================
# Type Declaration
# ==============================================

type mtk_hal_mms, domain;
type mtk_hal_mms_exec, exec_type, file_type, vendor_file_type;

# ==============================================
# MTK Policy Rule
# ==============================================

# Setup for domain transition
init_daemon_domain(mtk_hal_mms)

# Allow to use HWBinder IPC
hwbinder_use(mtk_hal_mms);

# Allow a set of permissions required for a domain to be a server which provides a HAL implementation over HWBinder.
hal_server_domain(mtk_hal_mms, hal_mms)
typeattribute mtk_hal_mms untrusted_app_visible_halserver;

# add/find permission rule to hwservicemanager
add_hwservice(hal_mms_server, mtk_hal_mms_hwservice)

# Purpose : Allow to use kernel driver
allow mtk_hal_mms graphics_device:chr_file rw_file_perms;
allow mtk_hal_mms ion_device:chr_file r_file_perms;
allow mtk_hal_mms mtk_cmdq_device:chr_file r_file_perms;
allow mtk_hal_mms mtk_mdp_device:chr_file rw_file_perms;
allow mtk_hal_mms sw_sync_device:chr_file rw_file_perms;
allow mtk_hal_mms proc:file r_file_perms;

# Purpose : Allow to use allocator for JPEG
hal_client_domain(mtk_hal_mms, hal_allocator)
hal_client_domain(mtk_hal_mms, hal_graphics_allocator);
hal_client_domain(mtk_hal_mms, hal_pq)

# Purpose : Allow to use mms by JPEG with handle
allow mtk_hal_mms platform_app:fd use;
# Purpose : Allow Miravision to set Sharpness
allow mtk_hal_mms system_app:fd use;
