type mobicore, domain;
type mobicore_exec, exec_type, file_type, vendor_file_type;
init_daemon_domain(mobicore)
allow mobicore mobicore_admin_device:chr_file rw_file_perms;
allow mobicore mobicore_user_device:chr_file rw_file_perms;
allow mobicore mobicore_data_file:dir { create rw_dir_perms rename reparent };
allow mobicore mobicore_data_file:file { create_file_perms rw_file_perms };
allow mobicore mobicore_tui_device:chr_file { read open ioctl };
allow hal_keymaster_attestation mobicore:unix_stream_socket connectto;
allow hal_keymaster_attestation mobicore_user_device:chr_file { read write ioctl open };
allow mobicore unlabeled:dir search;
allow mobicore mnt_vendor_file:dir search;
allow mobicore persist_data_file:dir { ra_dir_perms };
allow mobicore persist_data_file:file { read write create open getattr };
