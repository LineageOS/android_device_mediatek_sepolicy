type atcid, domain;
type atcid_exec, exec_type, file_type, vendor_file_type;

init_daemon_domain(atcid)

hal_client_domain(atcid, hal_telephony)
hal_client_domain(atcid, hal_pq)
hal_server_domain(atcid, hal_atci)

set_prop(atcid,persist_service_atci_prop)
get_prop(atcid, tel_switch_prop)

allow atcid block_device:dir search;
allow atcid gsmrild_socket:sock_file write;

hwbinder_use(atcid)
hwbinder_use(atcid);
vndbinder_use(atcid);

allow atcid ttyGS_device:chr_file { read write ioctl open };
allow atcid wmtWifi_device:chr_file { write open };
allow atcid misc2_block_device:blk_file { read write open };
allow atci_service gpu_device:chr_file { read write open ioctl getattr };
allow atcid self:capability sys_time;
allow atcid proc_ged:file rw_file_perms;
allow atcid meta_tst:unix_stream_socket connectto;
allow atcid sysfs_batteryinfo:file { read open };

add_hwservice(hal_atci_server,hal_atci_hwservice)

set_prop(atcid, mtk_atci_prop);
set_prop(atcid, powerctl_prop);

allow atcid mnt_vendor_file:dir search;
allow atcid nvdata_file:dir { open read write search add_name };
allow atcid nvdata_file:file { open read write create getattr setattr };
allow atcid nvram_device:blk_file { open read write };
allow atcid proc_meminfo:file { open read };
allow atcid sysfs_batteryinfo:dir search;
allow atcid sysfs_mmcblk:dir search;
allow atcid sysfs_mmcblk:file { read open };

unix_socket_connect(atcid, rild_atci, rild);
unix_socket_connect(atcid, rilproxy_atci, rild);
unix_socket_connect(atcid, atci_service, atci_service);
unix_socket_connect(atcid, atci-audio, audiocmdservice_atci);
unix_socket_connect(atcid, meta_atci, meta_tst);

allow atcid adb_atci_socket:sock_file write;
